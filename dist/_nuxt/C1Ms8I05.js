import{_ as M,k as N,$ as U,l as E,c,o as u,g as V,a,L as B,K as P,D as z,M as D,E as T,b as y,w as j,d as L,e as X,t as v,f as G,n as S,y as O}from"./D_JQTfwH.js";import $ from"./BTW-WEoa.js";const J={"aria-hidden":!0,class:"payment-animated",ref:"root"},K={__name:"payments",props:{duration:{type:Number,default:1100},autoplay:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},pingpong:{type:Boolean,default:!0},delay:{type:Number,default:0}},setup(x){const o=x,_=N(null);let n=null,h=null,p=!1;return U(()=>{p=!0,n&&cancelAnimationFrame(n),h&&clearTimeout(h)}),E(()=>{const s=_.value,f=i=>s==null?void 0:s.querySelector(`#${i}`),m=[{id:"g_main_left",el:f("g_main_left"),from:[1,0,0,1,54.76202392578125,164.43899536132812],to:[.9093958139419556,.4159318208694458,-.4159318208694458,.9093958139419556,110.55703735351562,3.8417816162109375]},{id:"g_inner_white",el:f("g_inner_white"),from:[1,0,0,1,86.09302520751953,190.80599975585938],to:[.9093958139419556,.4159318208694458,-.4159318208694458,.9093958139419556,128.0824432373047,40.851383209228516]},{id:"g_dot_a",el:f("g_dot_a"),from:[1,0,0,1,319.98199462890625,337.7619934082031],to:[1,0,0,1,374.7802734375,338.3525390625]},{id:"g_dot_b",el:f("g_dot_b"),from:[1,0,0,1,376.781005859375,338.33599853515625],to:[1,0,0,1,321.9657287597656,337.7957458496094]}].filter(i=>i.el);if(!m.length){console.warn("[PaymentAnimated] Не найдены целевые группы внутри SVG (id mismatch).");return}const k=typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches?0:Math.max(0,o.duration);function R(i){return i<.5?4*i*i*i:1-Math.pow(-2*i+2,3)/2}const F=(i,r,d)=>i+(r-i)*d;if(m.forEach(i=>{i.el.setAttribute("transform","matrix("+i.from.map(r=>+r.toFixed(6)).join(",")+")")}),!o.autoplay||k===0){o.autoplay&&k===0&&m.forEach(i=>{i.el.setAttribute("transform","matrix("+i.to.map(r=>+r.toFixed(6)).join(",")+")")});return}let w=1,t=null;function e(i){if(p)return;t||(t=i);const r=i-t,d=Math.min(1,r/k),A=R(d),I=w===1?A:1-A;if(m.forEach(l=>{const g=l.from.map((b,C)=>F(b,l.to[C],I));l.el.setAttribute("transform","matrix("+g.map(b=>+b.toFixed(6)).join(",")+")")}),d<1){n=requestAnimationFrame(e);return}o.pingpong?(w*=-1,t=null,o.loop||w===-1?n=requestAnimationFrame(e):m.forEach(l=>{l.el.setAttribute("transform","matrix("+l.from.map(g=>+g.toFixed(6)).join(",")+")")})):o.loop?(w=1,t=null,n=requestAnimationFrame(e)):m.forEach(l=>{l.el.setAttribute("transform","matrix("+l.to.map(g=>+g.toFixed(6)).join(",")+")")})}o.delay>0?h=setTimeout(()=>{p||(n=requestAnimationFrame(e))},o.delay):n=requestAnimationFrame(e)}),(s,f)=>(u(),c("div",J,[(u(),c("svg",{ref_key:"svgRoot",ref:_,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512",width:"512",height:"512",preserveAspectRatio:"xMidYMid meet",style:{width:"100%",height:"100%",background:"transparent",display:"block"}},f[0]||(f[0]=[V('<defs data-v-84362868><clipPath id="__lottie_element_22" data-v-84362868><rect width="512" height="512" x="0" y="0" data-v-84362868></rect></clipPath></defs><g clip-path="url(#__lottie_element_22)" data-v-84362868><g id="g_main_left" transform="matrix(1,0,0,1,54.76202392578125,164.43899536132812)" opacity="1" style="display:block;" data-v-84362868><g opacity="1" transform="matrix(1,0,0,1,220.85400390625,129.1739959716797)" data-v-84362868><path fill="rgb(81,18,215)" fill-opacity="1" d=" M177.03900146484375,128.9250030517578 C177.03900146484375,128.9250030517578 -177.03799438476562,128.9250030517578 -177.03799438476562,128.9250030517578 C-201.0989990234375,128.9250030517578 -220.60400390625,109.41999816894531 -220.60400390625,85.36000061035156 C-220.60400390625,85.36000061035156 -220.60400390625,-85.35900115966797 -220.60400390625,-85.35900115966797 C-220.60400390625,-109.41899871826172 -201.0989990234375,-128.9239959716797 -177.03799438476562,-128.9239959716797 C-177.03799438476562,-128.9239959716797 177.03900146484375,-128.9239959716797 177.03900146484375,-128.9239959716797 C201.10000610351562,-128.9239959716797 220.60499572753906,-109.41899871826172 220.60499572753906,-85.35900115966797 C220.60499572753906,-85.35900115966797 220.60400390625,85.36000061035156 220.60400390625,85.36000061035156 C220.60400390625,109.41999816894531 201.10000610351562,128.9250030517578 177.03900146484375,128.9250030517578z" data-v-84362868></path></g></g><g id="g_inner_white" transform="matrix(1,0,0,1,86.09302520751953,190.80599975585938)" opacity="1" style="display:block;" data-v-84362868><g opacity="1" transform="matrix(1,0,0,1,61.165000915527344,25.02899932861328)" data-v-84362868><path fill="rgb(255,255,255)" fill-opacity="1" d=" M47.30799865722656,24.77899932861328 C47.30799865722656,24.77899932861328 -47.30799865722656,24.77899932861328 -47.30799865722656,24.77899932861328 C-54.821998596191406,24.77899932861328 -60.915000915527344,18.687000274658203 -60.915000915527344,11.17199993133545 C-60.915000915527344,11.17199993133545 -60.915000915527344,-11.17199993133545 -60.915000915527344,-11.17199993133545 C-60.915000915527344,-18.687000274658203 -54.821998596191406,-24.77899932861328 -47.30799865722656,-24.77899932861328 C-47.30799865722656,-24.77899932861328 47.30799865722656,-24.77899932861328 47.30799865722656,-24.77899932861328 C54.823001861572266,-24.77899932861328 60.915000915527344,-18.687000274658203 60.915000915527344,-11.17199993133545 C60.915000915527344,-11.17199993133545 60.915000915527344,11.17199993133545 60.915000915527344,11.17199993133545 C60.915000915527344,18.687000274658203 54.823001861572266,24.77899932861328 47.30799865722656,24.77899932861328z" data-v-84362868></path></g></g><g transform="matrix(1,0,0,1,57.675994873046875,197.90199279785156)" opacity="1" style="display:block;" data-v-84362868><g opacity="1" transform="matrix(1,0,0,1,220.85400390625,129.1739959716797)" data-v-84362868><path fill="rgb(156,115,246)" fill-opacity="1" d=" M177.03900146484375,128.9239959716797 C177.03900146484375,128.9239959716797 -177.03900146484375,128.92300415039062 -177.03900146484375,128.92300415039062 C-201.0989990234375,128.92300415039062 -220.60400390625,109.41799926757812 -220.60400390625,85.35800170898438 C-220.60400390625,85.35800170898438 -220.60400390625,-85.35900115966797 -220.60400390625,-85.35900115966797 C-220.60400390625,-109.41899871826172 -201.0989990234375,-128.9239959716797 -177.03799438476562,-128.9239959716797 C-177.03799438476562,-128.9239959716797 177.03900146484375,-128.9239959716797 177.03900146484375,-128.9239959716797 C201.10000610351562,-128.9239959716797 220.60400390625,-109.41899871826172 220.60400390625,-85.35800170898438 C220.60400390625,-85.35800170898438 220.60400390625,85.35900115966797 220.60400390625,85.35900115966797 C220.60400390625,109.41899871826172 201.10000610351562,128.9239959716797 177.03900146484375,128.9239959716797z" data-v-84362868></path></g></g><g id="g_dot_a" transform="matrix(1,0,0,1,319.98199462890625,337.7619934082031)" opacity="1" style="display:block;" data-v-84362868><g opacity="1" transform="matrix(1,0,0,1,38.32699966430664,38.32699966430664)" data-v-84362868><path fill="rgb(95,52,186)" fill-opacity="1" d=" M37.86600112915039,0.382999986410141 C37.654998779296875,21.29599952697754 20.530000686645508,38.07699966430664 -0.382999986410141,37.86600112915039 C-21.295000076293945,37.654998779296875 -38.07699966430664,20.530000686645508 -37.86600112915039,-0.38199999928474426 C-37.654998779296875,-21.295000076293945 -20.530000686645508,-38.07699966430664 0.382999986410141,-37.8650016784668 C21.295000076293945,-37.65399932861328 38.07699966430664,-20.530000686645508 37.86600112915039,0.382999986410141z" data-v-84362868></path></g></g><g id="g_dot_b" transform="matrix(1,0,0,1,376.781005859375,338.33599853515625)" opacity="1" style="display:block;" data-v-84362868><g opacity="1" transform="matrix(1,0,0,1,38.32699966430664,38.32699966430664)" data-v-84362868><path fill="rgb(81,18,215)" fill-opacity="1" d=" M-37.86600112915039,-0.382999986410141 C-38.07699966430664,20.530000686645508 -21.295000076293945,37.65399932861328 -0.382999986410141,37.8650016784668 C20.530000686645508,38.07699966430664 37.654998779296875,21.295000076293945 37.8650016784668,0.38199999928474426 C38.07699966430664,-20.530000686645508 21.295000076293945,-37.654998779296875 0.382999986410141,-37.86600112915039 C-20.5310001373291,-38.07699966430664 -37.654998779296875,-21.29599952697754 -37.86600112915039,-0.382999986410141z" data-v-84362868></path></g></g><g transform="matrix(1,0,0,1,58.31298828125,241.26498413085938)" opacity="1" style="display:block;" data-v-84362868><g opacity="1" transform="matrix(1,0,0,1,219.87600708007812,24.878999710083008)" data-v-84362868><path fill="rgb(45,45,45)" fill-opacity="1" d=" M219.62600708007812,24.628000259399414 C219.62600708007812,24.628000259399414 -219.62600708007812,24.628000259399414 -219.62600708007812,24.628000259399414 C-219.62600708007812,24.628000259399414 -219.625,-24.628000259399414 -219.625,-24.628000259399414 C-219.625,-24.628000259399414 219.62600708007812,-24.628000259399414 219.62600708007812,-24.628000259399414 C219.62600708007812,-24.628000259399414 219.62600708007812,24.628000259399414 219.62600708007812,24.628000259399414z" data-v-84362868></path></g></g></g>',2)]),512))],512))}},Y=M(K,[["__scopeId","data-v-84362868"]]),H=""+new URL("coding.v5rNLOjs.mp4",import.meta.url).href,Q={};function W(x,o){return u(),c("div",null,o[0]||(o[0]=[a("video",{autoplay:"",muted:"",loop:"",class:"img__video",playsinline:""},[a("source",{src:H,type:"video/mp4"})],-1)]))}const Z=M(Q,[["render",W],["__scopeId","data-v-0eeb2f54"]]),t0=""+new URL("domain.22L7smSX.mp4",import.meta.url).href,e0={};function a0(x,o){return u(),c("div",null,o[0]||(o[0]=[a("video",{autoplay:"",muted:"",loop:"",class:"img__video",playsinline:""},[a("source",{src:t0,type:"video/mp4"})],-1)]))}const i0=M(e0,[["render",a0],["__scopeId","data-v-7e62d75c"]]),r0=""+new URL("succeed.CxV5e8yX.mp4",import.meta.url).href,s0={};function o0(x,o){return u(),c("div",null,o[0]||(o[0]=[a("video",{autoplay:"",muted:"",loop:"",class:"img__video",playsinline:""},[a("source",{src:r0,type:"video/mp4"})],-1)]))}const n0=M(s0,[["render",o0],["__scopeId","data-v-ad3d0870"]]),l0={class:"od-page"},d0={class:"od-container"},c0={key:0,class:"od-loading"},u0={key:1,class:"od-error"},p0={key:2,class:"od-empty"},m0={key:3,class:"od-card"},_0={class:"od-top"},f0=["src"],v0={class:"od-info"},g0={class:"od-title"},y0={class:"od-meta"},h0={class:"order-status__container"},w0={class:"od-price"},b0={class:"od-section"},C0={class:"od-grid"},x0={class:"od-grid-item"},k0={class:"od-grid-item"},A0={class:"od-grid-item"},S0={class:"od-grid-item"},N0={class:"od-section"},M0={class:"od-section__steps"},F0={class:"info__block"},I0={class:"info__block"},R0={class:"info__block"},O0={class:"info__block"},$0={__name:"[id]",setup(x){const o=B();P();const _=z(),n=N(o.params.id??o.params.orderId??null),h=N(!1),p=N(null),s=N({});D(()=>o.params.id,t=>{n.value=t}),E(async()=>{await m()}),D(n,async(t,e)=>{t!==e&&await m()});function f(t){return t=="pending_payment"||t=="pending_yookassa_payment"?"Ожидает оплаты":t=="in_progress"?"В разработке":t=="deploying_domain"?"Подключение домена":t=="completed"?"Проект запущен":t=="cancelled"?"Отменен":"В разработке"}async function m(){var e;const t=n.value;if(!t){p.value="Не указан ID заказа",s.value={};return}h.value=!0,p.value=null;try{let i=null;if(Array.isArray(_.orders)&&(i=_.orders.find(r=>String(r.id??r.order_id??r._id)===String(t))),!i&&typeof _.fetchOrder=="function"){const r=await _.fetchOrder(t);r&&r.success&&r.data?i=r.data:r&&r.order?i=r.order:r&&r.data===void 0&&r.success&&(i=r)}if(!i&&typeof _.fetchUserOrders=="function"){const r=await _.fetchUserOrders({page:1,perPage:1});r&&r.success&&Array.isArray((e=r.data)==null?void 0:e.rows)&&r.data.rows.length>0&&(i=r.data.rows.find(d=>String(d.id??d.order_id??d._id)===String(t)))}if(!i){p.value="Не удалось найти заказ",s.value={};return}s.value=q(i)}catch(i){console.error("OrderDetailsPage loadOrder error",i),p.value=(i==null?void 0:i.message)??"Сетевая ошибка",s.value={}}finally{h.value=!1}}function q(t){var e,i;return t?{id:t.id??t.order_id??t._id??null,date:F(t),template:((e=t.template)==null?void 0:e.title)??((i=t.template)==null?void 0:i.name)??t.template_title??t.templateName??(typeof t.template=="string"?t.template:null)??"—",status:t.status??t.state??"—",statusCode:String(t.status??t.state??"").toLowerCase().replace(/\s+/g,"_")||"unknown",price:R(t),preview:k(t),raw:t}:{}}function k(t){var i,r,d,A,I,l,g,b;if(!t)return null;const e=[t.preview,(i=t.template)==null?void 0:i.image,(r=t.template)==null?void 0:r.preview,t.template_image,t.template_preview,t.image,(A=(d=t.raw)==null?void 0:d.template)==null?void 0:A.image,(l=(I=t.raw)==null?void 0:I.template)==null?void 0:l.preview,(g=t.raw)==null?void 0:g.template_image,(b=t.raw)==null?void 0:b.preview];for(const C of e)if(C&&typeof C=="string"&&C.trim()!=="")return C;return null}function R(t){const e=t.price??t.amount??t.total,i=t.currency??t.currency_code??"RUB";if(typeof e=="number"&&!Number.isNaN(e))try{return new Intl.NumberFormat("ru-RU",{style:"currency",currency:i}).format(e)}catch{return String(e)}return e??"—"}function F(t){if(!t)return"";const e=t.created_at??t.createdAt??t.date??t.order_date??t.created??t;let i;if(e instanceof Date)i=e;else if(typeof e=="number"){const r=e<1e12&&e<1e10?e*1e3:e;i=new Date(r)}else i=new Date(String(e));return Number.isNaN(i.getTime())?String(e??""):i.toLocaleString("ru-RU",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}function w(t){t.target.style.display="none"}return T(()=>{var t,e;try{return JSON.stringify(((t=s.value)==null?void 0:t.raw)??{},null,2)}catch{return String(((e=s.value)==null?void 0:e.raw)??"")}}),(t,e)=>{const i=X;return u(),c("div",l0,[a("div",d0,[y(i,{to:"/profile?tab=orders",class:"od-back"},{default:j(()=>e[0]||(e[0]=[L("← Мои заказы")])),_:1,__:[0]}),h.value?(u(),c("div",c0,"Загрузка заказа...")):p.value?(u(),c("div",u0,[L(" Ошибка: "+v(p.value)+" ",1),a("div",{style:{"margin-top":"1rem"}},[a("button",{class:"od-btn",onClick:m},"Повторить")])])):!s.value||!s.value.id?(u(),c("div",p0,"Заказ не найден")):(u(),c("div",m0,[a("div",_0,[s.value.raw.template.preview?(u(),c("img",{key:0,src:s.value.raw.template.preview,class:"od-thumb",onError:w,alt:"Превью шаблона"},null,40,f0)):G("",!0),a("div",v0,[a("h1",g0,v(s.value.raw.domain.fqdn??"—"),1),a("div",y0,"Дата: "+v(F(s.value.raw)),1),a("div",h0,[e[1]||(e[1]=a("p",null,"Статус:",-1)),a("div",{class:S(["od-meta",["profile-orders__status",`profile-orders__status--${s.value.raw.deploy_status}`]])},v(f(s.value.raw.deploy_status)),3)]),a("div",w0,v(s.value.price),1)])]),a("section",b0,[e[6]||(e[6]=a("h2",{class:"od-section-title"},"Детали заказа",-1)),a("div",C0,[a("div",x0,[e[2]||(e[2]=a("strong",null,"ID",-1)),a("div",null,v(s.value.id??"—"),1)]),a("div",k0,[e[3]||(e[3]=a("strong",null,"Шаблон",-1)),a("div",null,v(s.value.template??"—"),1)]),a("div",A0,[e[4]||(e[4]=a("strong",null,"Домен",-1)),a("div",null,v(s.value.raw.domain.fqdn??"—"),1)]),a("div",S0,[e[5]||(e[5]=a("strong",null,"Сумма",-1)),a("div",null,v(s.value.price),1)])])]),a("section",N0,[e[11]||(e[11]=a("h2",{class:"od-section-title"},"Этапы разработки",-1)),a("div",M0,[a("div",{class:S(["payment__container",{"step-active":s.value.raw.deploy_status==="pending_payment"||s.value.raw.deploy_status==="pending_yookassa_payment"}])},[a("div",F0,[y(Y,{class:"image__container"}),e[7]||(e[7]=a("div",{class:"info__about"},[a("h3",null,"Ожидает оплаты"),a("p",null,"Заказ создан, но оплата ещё не прошла")],-1))]),y(O($),{class:"vector-right__svg"})],2),a("div",{class:S(["coding__container",{"step-active":s.value.raw.deploy_status==="in_progress"}])},[a("div",I0,[y(Z,{class:"image__container"}),e[8]||(e[8]=a("div",{class:"info__about"},[a("h3",null,"В разработке"),a("p",null,"Проект в работе — наши разработчики готовят сайт")],-1))]),y(O($),{class:"vector-right__svg"})],2),a("div",{class:S(["domain__container",{"step-active":s.value.raw.deploy_status==="deploying_domain"}])},[a("div",R0,[y(i0,{class:"image__container"}),e[9]||(e[9]=a("div",{class:"info__about"},[a("h3",null,"Подключение домена"),a("p",null,"Привязываем домен и настраиваем доступ по адресу")],-1))]),y(O($),{class:"vector-right__svg"})],2),a("div",{class:S(["succeed__container",{"step-active":s.value.raw.deploy_status==="completed"||s.value.raw.deploy_status==="succeed"}])},[a("div",O0,[y(n0,{class:"image__container"}),e[10]||(e[10]=a("div",{class:"info__about"},[a("h3",null,"Все готово"),a("p",null,"Сайт опубликован и доступен в сети")],-1))])],2)])]),e[12]||(e[12]=a("div",{class:"od-actions"},null,-1))]))])])}}},L0=M($0,[["__scopeId","data-v-cbf355b7"]]);export{L0 as default};
