import{_ as b,D as k,r as v,E as w,A as B,c as _,o as n,a as s,G as o,t as p,x as m,y,B as I,F as S,z as U,H as P,I as $,J as h}from"./C8OgziG3.js";const A={class:"profile-info"},C={class:"profile-info__header"},T={key:1,class:"profile-info__actions"},j=["disabled"],x={key:0,class:"profile-info__content"},D={class:"profile-info__item"},V={class:"profile-info__value"},z={class:"profile-info__item"},N={class:"profile-info__value"},E={class:"profile-info__item"},L={class:"profile-info__value"},O={class:"profile-info__item"},F={class:"profile-info__value"},M={key:1,class:"profile-info__form"},J={class:"profile-info__form-group"},R={class:"profile-info__form-group"},G={class:"profile-info__form-group"},H={class:"profile-info__form-group"},q={__name:"ProfileInfo",setup(g){const r=k(),f=v({name:"Иван Иванов",email:"ivan@example.com",phone:"+7 (999) 123-45-67",telegram:"@ivanov"}),c=v(!1),t=v({...f.value}),i=v(!1);w(async()=>{await u()});const u=async()=>{try{i.value=!0;const l=await fetch(`${B.fullUrl}/user/profile`,{headers:{Authorization:`Bearer ${r.token}`}});if(l.ok){const e=await l.json();e.success&&(f.value=e.data,t.value={...e.data})}}catch(l){console.error("Ошибка загрузки профиля:",l)}finally{i.value=!1}},d=async()=>{try{i.value=!0;const l=await fetch(`${B.fullUrl}/user/profile`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.token}`},body:JSON.stringify(t.value)});if(l.ok){const e=await l.json();e.success&&(f.value={...e.data},c.value=!1,r.user=e.data)}else{const e=await l.json();alert(e.error||"Ошибка обновления профиля")}}catch(l){console.error("Ошибка сохранения профиля:",l),alert("Ошибка сохранения профиля")}finally{i.value=!1}};return(l,e)=>(n(),_("div",A,[s("div",C,[e[6]||(e[6]=s("h2",{class:"profile-info__title"},"Личные данные",-1)),o(c)?(n(),_("div",T,[s("button",{class:"button button--outline",onClick:e[1]||(e[1]=a=>c.value=!1)}," Отмена "),s("button",{class:"button button--primary",disabled:o(i),onClick:d},p(o(i)?"Сохранение...":"Сохранить"),9,j)])):(n(),_("button",{key:0,class:"button button--outline",onClick:e[0]||(e[0]=a=>c.value=!0)}," Редактировать "))]),o(c)?(n(),_("form",M,[s("div",J,[e[11]||(e[11]=s("label",{class:"profile-info__form-label"},"Имя",-1)),m(s("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>o(t).name=a),type:"text",class:"profile-info__form-input"},null,512),[[y,o(t).name]])]),s("div",R,[e[12]||(e[12]=s("label",{class:"profile-info__form-label"},"Email",-1)),m(s("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>o(t).email=a),type:"email",class:"profile-info__form-input"},null,512),[[y,o(t).email]])]),s("div",G,[e[13]||(e[13]=s("label",{class:"profile-info__form-label"},"Телефон",-1)),m(s("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>o(t).phone=a),type:"tel",class:"profile-info__form-input"},null,512),[[y,o(t).phone]])]),s("div",H,[e[14]||(e[14]=s("label",{class:"profile-info__form-label"},"Telegram",-1)),m(s("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>o(t).telegram=a),type:"text",class:"profile-info__form-input"},null,512),[[y,o(t).telegram]])])])):(n(),_("div",x,[s("div",D,[e[7]||(e[7]=s("span",{class:"profile-info__label"},"Имя:",-1)),s("span",V,p(o(f).name),1)]),s("div",z,[e[8]||(e[8]=s("span",{class:"profile-info__label"},"Email:",-1)),s("span",N,p(o(f).email),1)]),s("div",E,[e[9]||(e[9]=s("span",{class:"profile-info__label"},"Телефон:",-1)),s("span",L,p(o(f).phone),1)]),s("div",O,[e[10]||(e[10]=s("span",{class:"profile-info__label"},"Telegram:",-1)),s("span",F,p(o(f).telegram),1)])]))]))}},K=b(q,[["__scopeId","data-v-9f526a4a"]]),Q={class:"profile-orders"},W={key:0,class:"profile-orders__loading"},X={key:1,class:"profile-orders__empty"},Y={key:2,class:"profile-orders__table"},Z={class:"profile-orders__cell"},ss={class:"profile-orders__cell"},es={class:"profile-orders__cell"},ts={class:"profile-orders__cell"},os={class:"profile-orders__cell"},is={__name:"ProfileOrders",setup(g){const r=k(),f=v([]),c=v(!1);w(async()=>{await t()});const t=async()=>{try{c.value=!0;const i=await fetch(`${API.fullUrl}/user/orders`,{headers:{Authorization:`Bearer ${r.token}`}});if(i.ok){const u=await i.json();u.success&&(f.value=u.data.map(d=>({id:d.id,date:new Date(d.createdAt).toLocaleDateString("ru-RU"),template:d.templateName,status:d.statusText,price:`${d.price.toLocaleString()} ₽`,statusCode:d.status})))}}catch(i){console.error("Ошибка загрузки заказов:",i)}finally{c.value=!1}};return(i,u)=>(n(),_("div",Q,[u[2]||(u[2]=s("h2",{class:"profile-orders__title"},"Мои заказы",-1)),o(c)?(n(),_("div",W," Загрузка заказов... ")):o(f).length===0?(n(),_("div",X," У вас пока нет заказов ")):(n(),_("div",Y,[u[1]||(u[1]=I('<div class="profile-orders__row profile-orders__row--header" data-v-f6ff993f><div class="profile-orders__cell" data-v-f6ff993f>ID заказа</div><div class="profile-orders__cell" data-v-f6ff993f>Дата</div><div class="profile-orders__cell" data-v-f6ff993f>Шаблон</div><div class="profile-orders__cell" data-v-f6ff993f>Статус</div><div class="profile-orders__cell" data-v-f6ff993f>Сумма</div><div class="profile-orders__cell" data-v-f6ff993f>Действия</div></div>',1)),(n(!0),_(S,null,U(o(f),d=>(n(),_("div",{key:d.id,class:"profile-orders__row"},[s("div",Z,p(d.id),1),s("div",ss,p(d.date),1),s("div",es,p(d.template),1),s("div",ts,[s("span",{class:P(["profile-orders__status",`profile-orders__status--${d.statusCode}`])},p(d.status),3)]),s("div",os,p(d.price),1),u[0]||(u[0]=s("div",{class:"profile-orders__cell"},[s("button",{class:"profile-orders__action"}," Подробнее ")],-1))]))),128))]))]))}},ls=b(is,[["__scopeId","data-v-f6ff993f"]]),as={class:"profile-balance"},ns={class:"profile-balance__header"},rs={class:"profile-balance__amount"},_s=["disabled"],fs={class:"profile-balance__history"},ds={key:0,class:"profile-balance__loading"},ps={key:1,class:"profile-balance__empty"},cs={key:2,class:"profile-balance__list"},us={class:"profile-balance__info"},vs={class:"profile-balance__date"},ms={class:"profile-balance__desc"},bs={__name:"ProfileBalance",setup(g){const r=k(),f=v(0),c=v([]),t=v(!1);w(async()=>{await i(),await u()});const i=async()=>{try{const l=await fetch(`${API.fullUrl}/user/profile`,{headers:{Authorization:`Bearer ${r.token}`}});if(l.ok){const e=await l.json();e.success&&(f.value=e.data.balance||0)}}catch(l){console.error("Ошибка загрузки баланса:",l)}},u=async()=>{try{t.value=!0;const l=await fetch(`${API.fullUrl}/user/transactions`,{headers:{Authorization:`Bearer ${r.token}`}});if(l.ok){const e=await l.json();e.success&&(c.value=e.data.map(a=>({id:a.id,date:new Date(a.createdAt).toLocaleDateString("ru-RU"),description:a.description,amount:`${a.amount>0?"+":""}${a.amount.toLocaleString()} ₽`,type:a.type})))}}catch(l){console.error("Ошибка загрузки транзакций:",l)}finally{t.value=!1}},d=async()=>{const l=prompt("Введите сумму для пополнения:");if(!l||isNaN(l)||l<=0){alert("Введите корректную сумму");return}try{t.value=!0;const e=await fetch(`${API.fullUrl}/user/balance/topup`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.token}`},body:JSON.stringify({amount:parseInt(l)})});if(e.ok)(await e.json()).success&&(alert("Баланс успешно пополнен!"),await i(),await u());else{const a=await e.json();alert(a.error||"Ошибка пополнения баланса")}}catch(e){console.error("Ошибка пополнения баланса:",e),alert("Ошибка пополнения баланса")}finally{t.value=!1}};return(l,e)=>(n(),_("div",as,[s("div",ns,[e[0]||(e[0]=s("h2",{class:"profile-balance__title"},"Баланс",-1)),s("div",rs,p(o(f).toLocaleString())+" ₽ ",1)]),s("button",{class:"button button--primary profile-balance__button",disabled:o(t),onClick:d},p(o(t)?"Пополнение...":"Пополнить баланс"),9,_s),s("div",fs,[e[1]||(e[1]=s("h3",{class:"profile-balance__subtitle"},"История операций",-1)),o(t)?(n(),_("div",ds," Загрузка операций... ")):o(c).length===0?(n(),_("div",ps," У вас пока нет операций ")):(n(),_("div",cs,[(n(!0),_(S,null,U(o(c),a=>(n(),_("div",{key:a.id,class:"profile-balance__item"},[s("div",us,[s("div",vs,p(a.date),1),s("div",ms,p(a.description),1)]),s("div",{class:P(["profile-balance__sum",a.type==="income"?"profile-balance__sum--income":"profile-balance__sum--expense"])},p(a.amount),3)]))),128))]))])]))}},gs=b(bs,[["__scopeId","data-v-682a4482"]]),ys={class:"profile-settings"},$s={class:"profile-settings__section"},hs={class:"profile-settings__option"},ks={class:"profile-settings__switch"},ws={class:"profile-settings__option"},Ss={class:"profile-settings__switch"},Us={class:"profile-settings__option"},Ps={class:"profile-settings__switch"},Bs={class:"profile-settings__section"},Is={class:"profile-settings__option"},As={class:"profile-settings__switch"},Cs={__name:"ProfileSettings",setup(g){const r=v({email:!0,telegram:!0,sms:!1}),f=v({twoFactor:!1});return(c,t)=>(n(),_("div",ys,[t[14]||(t[14]=s("h2",{class:"profile-settings__title"},"Настройки",-1)),s("div",$s,[t[10]||(t[10]=s("h3",{class:"profile-settings__subtitle"},"Уведомления",-1)),s("div",hs,[t[5]||(t[5]=s("div",{class:"profile-settings__option-info"},[s("div",{class:"profile-settings__option-title"},"Email уведомления"),s("div",{class:"profile-settings__option-desc"},"Получать новости и обновления на почту")],-1)),s("label",ks,[m(s("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=i=>o(r).email=i),class:"profile-settings__switch-input"},null,512),[[$,o(r).email]]),t[4]||(t[4]=s("span",{class:"profile-settings__switch-slider"},null,-1))])]),s("div",ws,[t[7]||(t[7]=s("div",{class:"profile-settings__option-info"},[s("div",{class:"profile-settings__option-title"},"Telegram уведомления"),s("div",{class:"profile-settings__option-desc"},"Получать важные уведомления в Telegram")],-1)),s("label",Ss,[m(s("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=i=>o(r).telegram=i),class:"profile-settings__switch-input"},null,512),[[$,o(r).telegram]]),t[6]||(t[6]=s("span",{class:"profile-settings__switch-slider"},null,-1))])]),s("div",Us,[t[9]||(t[9]=s("div",{class:"profile-settings__option-info"},[s("div",{class:"profile-settings__option-title"},"SMS уведомления"),s("div",{class:"profile-settings__option-desc"},"Получать важные уведомления по SMS")],-1)),s("label",Ps,[m(s("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=i=>o(r).sms=i),class:"profile-settings__switch-input"},null,512),[[$,o(r).sms]]),t[8]||(t[8]=s("span",{class:"profile-settings__switch-slider"},null,-1))])])]),s("div",Bs,[t[13]||(t[13]=s("h3",{class:"profile-settings__subtitle"},"Безопасность",-1)),s("div",Is,[t[12]||(t[12]=s("div",{class:"profile-settings__option-info"},[s("div",{class:"profile-settings__option-title"},"Двухфакторная аутентификация"),s("div",{class:"profile-settings__option-desc"},"Дополнительная защита вашего аккаунта")],-1)),s("label",As,[m(s("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=i=>o(f).twoFactor=i),class:"profile-settings__switch-input"},null,512),[[$,o(f).twoFactor]]),t[11]||(t[11]=s("span",{class:"profile-settings__switch-slider"},null,-1))])])]),t[15]||(t[15]=s("div",{class:"profile-settings__section"},[s("h3",{class:"profile-settings__subtitle"},"Удаление аккаунта"),s("button",{class:"button button--danger"}," Удалить аккаунт ")],-1))]))}},Ts=b(Cs,[["__scopeId","data-v-7489b2d4"]]),js={class:"profile"},xs={class:"profile__tabs"},Ds=["onClick"],Vs={class:"profile__content"},zs={__name:"profile",setup(g){const r=v("info"),f=[{id:"info",title:"Профиль"},{id:"orders",title:"Мои заказы"},{id:"balance",title:"Баланс"},{id:"settings",title:"Настройки"}];return(c,t)=>(n(),_("div",js,[t[0]||(t[0]=s("div",{class:"profile__header"},[s("h1",{class:"profile__title"},"Личный кабинет"),s("p",{class:"profile__subtitle"},"Управляйте своими заказами и настройками")],-1)),s("div",xs,[(n(),_(S,null,U(f,i=>s("button",{key:i.id,class:P(["profile__tab",{"profile__tab--active":o(r)===i.id}]),onClick:u=>r.value=i.id},p(i.title),11,Ds)),64))]),s("div",Vs,[o(r)==="info"?(n(),h(K,{key:0})):o(r)==="orders"?(n(),h(ls,{key:1})):o(r)==="balance"?(n(),h(gs,{key:2})):(n(),h(Ts,{key:3}))])]))}},Es=b(zs,[["__scopeId","data-v-65c33268"]]);export{Es as default};
